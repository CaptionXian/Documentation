# 单次查询数据合约

数据合约是链上的一类智能合约，数据合约在链上支持数据的交易的和结算。数据合约的功能大致分为三个部分：

1. 数据合约签约管理
2. 数据合约基本信息管理
3. 数据合约订单管理

### 1. 数据合约中的几个角色：

* 数据需求方：作为需求方参与到合约中，通过支付数积分获取数据服务。
* 数据提供方：作为服务的提供方参与到合约中，提供数据服务并获得数积分报酬。
* 数据合约管理者：数据合约部署的时候，指定数据合约的管理者，管理者可以修改数据合约的一些基本信息，例如合约名称、模型信息等。

### 2. 数据合约签约管理
数据合约中，想要进行数据交易的需求提供双方，必须彼此互相完成签约操作。用户参与合约时，可以选择自己作为何角色，参与到合约之后，可以在对应的需求方或提供方列表中，选择自己想要签约的对象，当双方都完成签约后，供需两方才可以进行交易。


### 3. 数据合约基本信息管理
只有数据合约是无法进行数据查询的，需要链下的sdk的部署和支持才行。因此合约中记录了很多支持sdk工作的信息。合约初始化的时候会指定一个管理者的账号，这些信息只可以被合约的管理者修改。

### 4. 数据合约订单管理

对于不同的数据合约，最大的区别是计价方式和订单的结算的不同。而这一部分的实现都在数据合约的订单管理中。

对于当前数据合约的“订单管理”。合约的每一次查询，被看作是一个订单的流程：a. 需求方创建订单，b. 提供方提供结果，c. 需求方确认结果。这样一个顺序的流程走完，意味着这笔查询交易成功。

当前数据合约中数积分的结算：需求方在创建订单的时候，就将需要花费的数积分转入到合约中，根据合约中制订的分配规则，将数积分分配给参与的提供方。在需求方最终确认的时候，合约将数积分转账到对应提供方账号，这样就完成了数积分的结算。

### 合约代码

合约相关文件路径：[https://github.com/unitedata-org-public/Documentation/tree/master/contract](https://github.com/unitedata-org-public/Documentation/tree/master/contract)

此合约代码具有较好的通用性，如果业务逻辑符合可以直接使用上面文件夹中的wasm和abi文件进行数据合约部署。

